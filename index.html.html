<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Bodies Distance Map</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-routing-machine/3.2.12/leaflet-routing-machine.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-routing-machine/3.2.12/leaflet-routing-machine.min.js"></script>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-orange-500: rgba(168, 75, 47, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-cream-50);
            color: var(--color-slate-900);
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .sidebar {
            width: 350px;
            background: var(--color-white);
            border-right: 1px solid var(--color-gray-300);
            overflow-y: auto;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .sidebar h1 {
            font-size: 18px;
            margin-bottom: 8px;
            color: var(--color-slate-900);
        }

        .sidebar p {
            font-size: 13px;
            color: var(--color-gray-300);
            margin-bottom: 20px;
        }

        .map {
            flex: 1;
            position: relative;
        }

        .location-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .location-item {
            background: var(--color-cream-50);
            border: 1px solid var(--color-gray-300);
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .location-item:hover {
            background: var(--color-teal-500);
            color: var(--color-white);
            border-color: var(--color-teal-600);
            transform: translateX(4px);
        }

        .location-item.active {
            background: var(--color-teal-500);
            color: var(--color-white);
            border-color: var(--color-teal-600);
        }

        .location-name {
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .location-detail {
            font-size: 12px;
            opacity: 0.8;
        }

        .distance {
            font-weight: 600;
            color: var(--color-teal-500);
            margin-top: 6px;
        }

        .route-btn {
            background: var(--color-teal-500);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            margin-top: 6px;
            transition: all 0.2s ease;
        }

        .route-btn:hover {
            background: var(--color-teal-600);
        }

        .route-btn.active {
            background: var(--color-orange-500);
        }

        /* Hide default routing machine controls */
        .leaflet-routing-container {
            display: none;
        }

        .location-item.active .distance {
            color: var(--color-white);
        }

        .stats-box {
            background: var(--color-teal-500);
            color: var(--color-white);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 13px;
        }

        .stats-label {
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .stats-value {
            font-size: 18px;
            font-weight: 600;
        }

        .filter-box {
            margin-bottom: 16px;
        }

        .filter-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--color-gray-300);
            border-radius: 6px;
            font-size: 13px;
        }

        .filter-input:focus {
            outline: none;
            border-color: var(--color-teal-500);
            box-shadow: 0 0 0 3px rgba(33, 128, 141, 0.1);
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: 40%;
                border-right: none;
                border-bottom: 1px solid var(--color-gray-300);
            }

            .map {
                height: 60%;
            }
        }

        /* Leaflet custom marker styles */
        .leaflet-popup-content {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .leaflet-popup-content-wrapper {
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <h1>üåä Water Bodies</h1>
            <p>Distance from Raipur Railway Station</p>
            
            <div class="stats-box">
                <div class="stats-label">Total Locations:</div>
                <div class="stats-value" id="totalCount">22</div>
            </div>

            <div class="filter-box">
                <input type="text" class="filter-input" id="searchInput" placeholder="Search water body...">
            </div>

            <div class="location-list" id="locationList"></div>
        </div>

        <div class="map" id="map"></div>
    </div>

    <script>
        // Raipur Railway Station coordinates
        const RAIPUR_STATION = { lat: 21.2416, lng: 81.6326 };

        // Water bodies data from Excel
        const waterBodies = [
            { name: "Sheetla Talab", lat: 21.240065, lng: 81.669959, division: "Raipur", district: "Raipur", ulb: "Raipur" },
            { name: "Makai Talab", lat: 20.70437, lng: 81.548283, division: "Raipur", district: "Dhamtari", ulb: "Dhamtari" },
            { name: "Mohbhatta Talab", lat: 21.716644, lng: 81.550851, division: "Durg", district: "Bemetera", ulb: "Bemetera" },
            { name: "Revabandh Talab", lat: 22.00313, lng: 81.232254, division: "Durg", district: "Kabeerdham", ulb: "Kawardha" },
            { name: "Sindhola Talab", lat: 21.191318, lng: 80.752839, division: "Durg", district: "Rajnandgaon", ulb: "Dongargah" },
            { name: "Chatwa Talab", lat: 21.358236, lng: 81.41733, division: "Durg", district: "Durg", ulb: "Ahiwara" },
            { name: "Nawapara Talab", lat: 22.05337, lng: 81.67099, division: "Bilaspur", district: "Mungeli", ulb: "Mungeli" },
            { name: "Dabripara Talab", lat: 22.274023, lng: 81.700565, division: "Bilaspur", district: "Mungeli", ulb: "Lormi" },
            { name: "Daniha Talab", lat: 22.264973, lng: 82.144483, division: "Bilaspur", district: "Bilaspur", ulb: "Ratanpur" },
            { name: "Krishnarjuni Talab", lat: 22.29245, lng: 82.16697, division: "Bilaspur", district: "Bilaspur", ulb: "Ratanpur" },
            { name: "Ratneshwar Talab", lat: 22.27357, lng: 82.16434, division: "Bilaspur", district: "Bilaspur", ulb: "Ratanpur" },
            { name: "Tonhi Talab", lat: 22.136163, lng: 81.873215, division: "Bilaspur", district: "Bilaspur", ulb: "Takathpur" },
            { name: "Joda Talab", lat: 22.101015, lng: 82.154156, division: "Bilaspur", district: "Bilaspur", ulb: "Bilaspur" },
            { name: "Harsagar Talab", lat: 22.1325, lng: 82.167454, division: "Bilaspur", district: "Bilaspur", ulb: "Bilaspur" },
            { name: "Maa Sharda Talab", lat: 22.03983, lng: 82.15345, division: "Bilaspur", district: "Bilaspur", ulb: "Bilaspur" },
            { name: "Maa Mahamaya Talab", lat: 22.09661, lng: 82.083323, division: "Bilaspur", district: "Bilaspur", ulb: "Bilaspur" },
            { name: "Sati Talab", lat: 22.885692, lng: 84.138764, division: "Surguja", district: "Jashpur", ulb: "Jashpur-Nagar" },
            { name: "Mahamaya Talab", lat: 23.119594, lng: 83.212391, division: "Surguja", district: "Surguja", ulb: "Ambikapur" },
            { name: "Chath Talab", lat: 22.745804, lng: 83.9564, division: "Surguja", district: "Jashpur", ulb: "Kunkuri" },
            { name: "Naii Talab", lat: 19.207781, lng: 81.93439, division: "Bastar", district: "Bastar", ulb: "Bastar" },
            { name: "Dudhawa Talab", lat: 20.26228, lng: 81.499356, division: "Bastar", district: "Kanker", ulb: "Kanker" }
        ];

        // Calculate distance between two coordinates using Haversine formula
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Earth's radius in km
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return (R * c).toFixed(2);
        }

        // Add distances to water bodies
        waterBodies.forEach(body => {
            body.distance = calculateDistance(RAIPUR_STATION.lat, RAIPUR_STATION.lng, body.lat, body.lng);
        });

        // Sort by distance
        waterBodies.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance));

        // Initialize map
        const map = L.map('map').setView([21.5, 81.5], 9);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // Custom marker colors
        const markerColors = {
            'Raipur': '#2180A0',
            'Durg': '#FF5459',
            'Bilaspur': '#E68161',
            'Surguja': '#A8B040',
            'Bastar': '#9C3EAC'
        };

        // Add markers to map
        const markers = {};
        waterBodies.forEach((body, index) => {
            const color = markerColors[body.division] || '#2180A0';
            const markerIcon = L.divIcon({
                className: 'custom-marker',
                html: `<div style="background: ${color}; width: 32px; height: 32px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 14px; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">${index + 1}</div>`,
                iconSize: [32, 32],
                iconAnchor: [16, 16],
                popupAnchor: [0, -16]
            });

            const marker = L.marker([body.lat, body.lng], { icon: markerIcon }).addTo(map);
            marker.bindPopup(`
                <div style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
                    <strong style="font-size: 14px;">${body.name}</strong><br>
                    <small style="color: #666;">
                        District: ${body.district}<br>
                        Division: ${body.division}<br>
                        <strong style="color: #2180A0;">Distance: ${body.distance} km</strong>
                    </small>
                </div>
            `);

            marker.on('click', () => {
                document.querySelectorAll('.location-item').forEach(el => el.classList.remove('active'));
                document.getElementById(`location-${index}`).classList.add('active');
            });

            markers[index] = marker;
        });

        // Add Raipur Station marker
        const stationIcon = L.divIcon({
            className: 'station-marker',
            html: `<div style="background: #2180A0; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3);">üöÇ</div>`,
            iconSize: [40, 40],
            iconAnchor: [20, 20],
            popupAnchor: [0, -20]
        });

        L.marker([RAIPUR_STATION.lat, RAIPUR_STATION.lng], { icon: stationIcon })
            .addTo(map)
            .bindPopup('<strong>Raipur Railway Station</strong><br><small>Reference Point</small>');

        // Populate sidebar
        const locationList = document.getElementById('locationList');
        waterBodies.forEach((body, index) => {
            const item = document.createElement('div');
            item.className = 'location-item';
            item.id = `location-${index}`;
            item.innerHTML = `
                <div class="location-name">${body.name}</div>
                <div class="location-detail">${body.district}, ${body.division}</div>
                <div class="distance">üìç ${body.distance} km away</div>
                <button class="route-btn" onclick="toggleRoute(${index})">üöó Show Route</button>
            `;

            item.addEventListener('click', () => {
                document.querySelectorAll('.location-item').forEach(el => el.classList.remove('active'));
                item.classList.add('active');
                map.setView([body.lat, body.lng], 12);
                markers[index].openPopup();
            });

            locationList.appendChild(item);
        });

        // Route management
        let routeControl = null;
        let activeRouteIndex = null;

        function toggleRoute(index) {
            const body = waterBodies[index];
            const btn = document.querySelectorAll('.route-btn')[index];

            if (activeRouteIndex === index) {
                // Remove route
                if (routeControl) {
                    map.removeControl(routeControl);
                    routeControl = null;
                }
                activeRouteIndex = null;
                btn.classList.remove('active');
            } else {
                // Remove previous route if any
                if (routeControl) {
                    map.removeControl(routeControl);
                }
                if (activeRouteIndex !== null) {
                    document.querySelectorAll('.route-btn')[activeRouteIndex].classList.remove('active');
                }

                // Create new route
                routeControl = L.Routing.control({
                    waypoints: [
                        L.latLng(RAIPUR_STATION.lat, RAIPUR_STATION.lng),
                        L.latLng(body.lat, body.lng)
                    ],
                    routeWhileDragging: false,
                    createMarker: () => null,
                    lineOptions: {
                        styles: [
                            { color: 'black', opacity: 0.15, weight: 9 },
                            { color: 'white', opacity: 0.8, weight: 6 },
                            { color: '#2180A0', opacity: 1, weight: 3, dashArray: '5, 5' }
                        ]
                    },
                    router: L.Routing.osrmv1({
                        serviceUrl: 'https://router.project-osrm.org/route/v1'
                    })
                }).addTo(map);

                activeRouteIndex = index;
                btn.classList.add('active');
                map.fitBounds(routeControl.getBounds().pad(0.1));
            }
        }

        // Search functionality
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const items = document.querySelectorAll('.location-item');
            items.forEach((item, index) => {
                const body = waterBodies[index];
                const matches = body.name.toLowerCase().includes(query) || body.district.toLowerCase().includes(query);
                item.style.display = matches ? 'block' : 'none';
            });
        });
    </script>
</body>
</html>